window.isomorphicDir="/platform/isomorphic/";
var eng={staticVersion:"v1200",operationBindings:[{operationType:"fetch",dataProtocol:"postMessage"},{operationType:"add",dataProtocol:"postMessage"},{operationType:"update",dataProtocol:"postMessage"},{operationType:"remove",dataProtocol:"postMessage"},{operationType:"validate",dataProtocol:"postMessage"},{operationType:"init",dataProtocol:"postMessage"},{operationType:"change",dataProtocol:"postMessage"}],config:{},dataStores:{},dataSources:{},fieldProcesors:{},validators:{},dataServices:{},dataProcessors:{},
formProcessors:{},authModules:{},userRepository:{},dataSourcesCache:{},id:0,dsCounter:0,dataSourceScriptPath:"",contextPath:"",dataSourceServlet:"/ds",onbeforeunloadForms:[],_requires:[],isServerSide:!1,array:function(a){var b=[];Array.isArray(a)?b=a:a&&b.push(a);b.remove=function(a){for(;-1!==(ax=b.indexOf(a));)b.splice(ax,1)};return b},startSubmitTimeOut:function(a){eng.submitTimeOut&&clearTimeout(eng.submitTimeOut);a&&null!=a&&(eng.submitButton=a,eng.submitButton.disable(),eng.submitTimeout=setTimeout(function(){eng.stopSubmitTimeOut()},
3E3))},stopSubmitTimeOut:function(){eng.submitTimeOut&&clearTimeout(eng.submitTimeOut);eng.submitButton&&eng.submitButton.enable()},linkFormGrid:function(a,b){a.formGrids||(a.formGrids=[]);a.formGrids.push(b);b.form=a},linkForm:function(a,b,c){a.linkToForms||(a.linkToForms=[]);b.linkFromForms||(b.linkFromForms=[]);a.linkToForms.push({form:b,link:c});b.linkFromForms.push({form:a,link:c})},getSubmitList:function(a,b){a.dataSource&&b.push(a);if(a.formGrids)for(var c=a.formGrids.length;c--;){var e=a.formGrids[c];
e.dataSource&&b.push(e)}if(a.linkToForms)for(c=a.linkToForms.length;c--;)eng.getSubmitList(a.linkToForms[c].form,b)},submitForm:function(a,b){var c=[];eng.getSubmitList(a,c);eng.submitList(c,b)},submitList:function(a,b,c){c||0==c||(c=a.length-1);if(0<=c){var e=a[c];e.getAllEditRows?eng.submitListGrid(e,a,b,c):eng.submitListForm(e,a,b,c)}else-1==c&&(eng.stopSubmitTimeOut(),b&&null!=b?b():isc.say("Datos enviados correctamente..."))},submitListGrid:function(a,b,c,e){if(null!=a){var f=a.getAllEditRows();
if(0<f.length){eng.startSubmitTimeOut();for(var g=eng.getDataSource(a.getDataSource().dsName),k=eng.array(a.canvasItem.dataValue),h=0;h<f.length;h++){var l=f[h],m=a.getEditValues(l);if(0<Object.keys(a.getEditValues(f[0])).length)if(a.recordMarkedAsRemoved(l))g.removeObj({_id:m._id}),k.remove(m._id);else if(a.isNewEditRecord(l)){var n=g.addObj(m);0==n.status?(a.setEditValues(l,n.data),k.push(n.data._id)):alert(n.error)}else n=g.updateObj(m),0==n.status?a.setEditValues(l,m):alert(n.error)}a.invalidate=
!0;0<k.length?a.form.saveItemValue(a.canvasItem,k):a.form.saveItemValue(a.canvasItem,null);eng.submitList(b,c,--e);a.canvasItem.showValue(k,k)}else eng.submitList(b,c,--e)}else eng.submitList(b,c,--e)},submitListForm:function(a,b,c,e){eng.startSubmitTimeOut();a.saveData(function(){a.rememberValues();if(a.linkFromForms)for(var f=0;f<a.linkFromForms.length;f++){var g=a.linkFromForms[f];g.form.setValue(g.link.name,a.getValue(g.link.valueField?g.link.valueField:"_id"))}if(null!=a.fromGrid){f=a.fromGrid;
g=[];for(var k,h=!0,l=a.getValue("_id"),m=a.getValue("_suri"),n=0;n<f.getTotalRows();n++)k=f.getRecord(n),null!=k&&(k=k._id)&&null!=k&&k!=m&&(g.push(k),l==k&&(h=!1));h&&g.push(l);f.invalidate=!0;f.canvasItem?(0<g.length?(f.canvasItem.form.saveItemValue(f.canvasItem,g),f.canvasItem.showValue(null,g)):(f.canvasItem.form.saveItemValue(f.canvasItem,null),f.canvasItem.showValue(null,null)),f.canvasItem.showValue(null,f.form.getValue(f.prop)),eng.submitForm(f.canvasItem.form)):f.form&&(0<g.length?f.form.setValue(f.prop,
g):f.form.setValue(f.prop,null))}a.window&&eng.submited==a&&a.window.closeClick();eng.submitList(b,c,--e)})},validateForm:function(a){a.handleAsyncValidationReply=function(b,e){0==b&&(eng.validates.isValid=!1,b=a.getErrors(),b.form=a,eng.validates.errors.push(b));eng.validates.remove(a)};var b=a.validate();1==a.isPendingAsyncValidation()&&eng.validates.push(a);if(0==b)return eng.validates.isValid=!1,b=a.getErrors(),b.form=a,eng.validates.errors.push(b),!1;if(a.linkToForms)for(b=0;b<a.linkToForms.length;b++)if(0==
eng.validateForm(a.linkToForms[b].form))return!1;if(a.formGrids)for(b=0;b<a.formGrids.length;b++)if(0==a.formGrids[b].canvasItem.validate())return!1;return!0},mergeAndArray:function(a,b){if(!b)return a;if(!a)return b;for(var c=[],e=0;e<b.length;e++)for(var f=0;f<a.length;f++)a[f].name===b[e].name&&c.push(eng.utils.clonAndMergeObjects(a[f],b[e]));return c},addLinks:function(a,b,c,e,f){if(a=eng.mergeAndArray(a,f.links))for(var g=0;g<a.length;g++){var k=a[g],h=eng.createDataSource(k.dataSource,!0,k);
if("subForm"===k.stype){null==h&&eng.processFields(k.fields);var l=isc.DynamicForm.create({numCols:k.numCols?k.numCols:2,width:k.width?k.width:"100%",left:k.left?k.left:"-8px",colWidths:k.colWidths?k.colWidths:[250,"*"],cellPadding:5,titleAlign:"right",titleOrientation:k.titleOrientation?k.titleOrientation:"left",disabled:!1,dataSource:h,fields:k.fields,values:k.values,canEdit:f.canEdit,autoDraw:!1});l.tindex=f.tindex;var m=isc.VStack.create({membersMargin:10,members:[isc.Label.create({contents:k.title,
width:"100%",height:25,autoDraw:!1,baseStyle:"exampleSeparator"}),l]});e.addMember(m);eng.linkForm(f,l,k);eng.addLinks(h?h.links:void 0,b,c,m,l)}else if("tab"===k.stype){null==h&&eng.processFields(k.fields);l=isc.DynamicForm.create({numCols:k.numCols?k.numCols:6,titleOrientation:k.titleOrientation?k.titleOrientation:"left",cellPadding:5,titleAlign:"right",disabled:!1,dataSource:h,fields:k.fields,autoDraw:!1});l.tindex=f.tindex+1;m=isc.VStack.create({members:[l]});var n={title:k.title,disabled:k.disabled,
enableWhen:k.enableWhen,pane:m,autoDraw:!1};b.addTab(n);eng.linkForm(f,l,k);eng.addLinks(h?h.links:void 0,b,n,m,l)}}},showFormErrors:function(){eng.stopSubmitTimeOut();for(var a="",b=null,c=0;c<eng.validates.errors.length;c++){var e=eng.validates.errors[c];for(property in e){var f=isc.DS.get(e.form.dataSource).fields[property];f&&(a+=f.title+": "+e[property]+"</br>",b=e.form)}}isc.warn(a);null!=b&&(a=eng.findObject(eng.submited.dataSource.dsName+"Tabs"))&&("undefined"===typeof b.tindex?a.selectTab(b.parentElement.tindex):
a.selectTab(b.tindex))},findObject:function(a){var b=null;try{b=eval(a)}catch(c){}return b},openURL:function(a,b){window.open(a,b).focus()},onbeforeunload:function(){for(var a=0;a<eng.onbeforeunloadForms.length;a++)if(eng.onbeforeunloadForms[a].valuesHaveChanged())return!1},submit:function(a,b,c){eng.startSubmitTimeOut(b);eng.submited=a;eng.validates=eng.array();eng.validates.isValid=!0;eng.validates.errors=[];if(1==eng.validateForm(a)&&1==eng.validates.isValid)if(0==eng.validates.length)eng.submitForm(a,
c);else var e=window.setInterval(function(){for(var b=!0,g=0;g<eng.validates.length;g++)1==eng.validates[g].isPendingAsyncValidation()&&(b=!1);1==b&&(window.clearInterval(e),1==eng.validates.isValid?eng.submitForm(a,c):eng.showFormErrors())},100);else eng.showFormErrors()},editFormFromGrid:function(a,b){a.editSelectedData(b);if(a.linkToForms)for(b=0;b<a.linkToForms.length;b++){var c=a.linkToForms[b];val=a.getValue(c.link.name);var e={};(e[c.link.valueField?c.link.valueField:"_id"]=val)&&eng.fetchForm(c.form,
e)}},fetchForm:function(a,b,c){a.fetchData(b,function(){if(a.formGrids)for(var b=0;b<a.formGrids.length;b++){var f=a.formGrids[b];if(f.prop){var g=a.getValue(f.prop);f.canvasItem.showValue(null,g)}}if(a.linkToForms)for(b=0;b<a.linkToForms.length;b++){f=a.linkToForms[b];g=a.getValue(f.link.name);var k={};(k[f.link.valueField?f.link.valueField:"_id"]=g)&&eng.fetchForm(f.form,k)}c&&c()})},resize:function(a){for(var b=0;b<a.items.length;b++)a.items[b].setWidth(a.items[b].getWidth());if(a.linkToForms)for(b=
0;b<a.linkToForms.length;b++)eng.resize(a.linkToForms[b].form);return!0},getDataSourceObjDef:function(a,b){var c={};a&&("string"==typeof a?(c.dsName=a,c.dsId="ds_"+a,!0===b&&(c.dsId+="_"+eng.dsCounter++)):a.fields?c.ds=a:a.ds?c.ds=a.ds:(a.dsName&&(c.dsName=a.dsName),a.dsId?c.dsId=a.dsId:(c.dsId="ds_"+a.dsName,!0===b&&(c.dsId+="_"+eng.dsCounter++))));return c},createDataSource:function(a,b,c){a=eng.getDataSourceObjDef(a,b);b=a.ds?a.ds:eng.dataSourcesCache[a.dsId];if(!b){var e=eng.utils.cloneObject(eng.dataSources[a.dsName]);
if(e)return eng.dataSourcesCache[a.dsId]=e,e.ID=a.dsId,e.dsName=a.dsName,e.dataFormat="json",e.dataURL=eng.contextPath+eng.dataSourceServlet+"?dssp="+eng.dataSourceScriptPath+"&ds="+a.dsName,e.operationBindings=eng.operationBindings,e.jsonPrefix="",e.jsonSuffix="",c&&c.fields&&(e.fields=eng.mergeAndArray(e.fields,c.fields)),eng.processFields(e.fields),null!=eng.getPrimaryKey(e.fields)?e.fields.unshift({name:"_id",type:"string",hidden:!0}):e.fields.unshift({name:"_id",type:"string",hidden:!0,primaryKey:!0}),
c=isc.RestDataSource.create(e),eng.dataSourcesCache[a.dsId]=c}return b},createGrid:function(a,b){b=eng.createDataSource(b);void 0===a.gridType&&(a.gridType="ListGrid");void 0===a.alternateRecordStyles&&(a.alternateRecordStyles=!0);void 0===a.emptyCellValue&&(a.emptyCellValue="--");void 0===a.dataPageSize&&(a.dataPageSize=100);void 0===a.dataSource&&(a.dataSource=b);void 0===a.autoFetchData&&(a.autoFetchData=!0);void 0===a.position&&(a.position="relative");void 0===a.canAddFormulaFields&&(a.canAddFormulaFields=
!0);void 0===a.canAddSummaryFields&&(a.canAddSummaryFields=!0);void 0===a.canEditHilites&&(a.canEditHilites=!0);void 0===a.canEdit&&(a.canEdit=!1);void 0===a.canAdd&&(a.canAdd=!1);void 0===a.canPrint&&(a.canPrint=!0);void 0===a.canExport&&(a.canExport=!0);void 0===a.warnOnRemoval&&(a.warnOnRemoval=!0);void 0===a.winEdit&&(a.winEdit=!1);a.winEdit&&(a.canEdit=!1);a.canRemoveRecords=eng.utils.removeAttribute(a,"canRemove");a.showFilterEditor=eng.utils.removeAttribute(a,"showFilter");void 0===a.autoResize&&
(a.autoResize=!1);void 0===a.resizeWidthMargin&&(a.resizeWidthMargin=0);void 0===a.resizeHeightMargin&&(a.resizeHeightMargin=0);var c=isc.Label.create({padding:5,autoDraw:!1});b=[c,isc.LayoutSpacer.create({width:"*"})];if(!0===a.canAdd){var e=isc.ToolStripButton.create({icon:"[SKIN]/actions/add.png",prompt:"Agregar nuevo registro",autoDraw:!1});b.push(e)}if(!0===a.canPrint){var f=isc.ToolStripButton.create({icon:"[SKIN]/actions/print.png",prompt:"Imprimir datos",autoDraw:!1});b.push(f)}if(1==a.canEditHilites){var g=
isc.ToolStripButton.create({icon:"[SKIN]/actions/column_preferences.png",prompt:"Agregar Marcadores",autoDraw:!1});b.push(g)}if(!0===a.canExport){var k=isc.ToolStripMenuButton.create({icon:"[SKIN]/actions/download.png",prompt:"Exportar Datos",title:"",autoDraw:!1});b.push(k)}b=isc.ToolStrip.create({width:"100%",height:24,members:b,autoDraw:!1});void 0===a.gridComponents&&(a.gridComponents=["filterEditor","header","body","summaryRow",b]);void 0===a.dataChanged&&(a.dataChanged=function(){this.Super("dataChanged",
arguments);var a=this.data.getLength();0<a&&(!this.data.lengthIsKnown||this.data.lengthIsKnown())?c.setContents(a+" Registros"):c.setContents(" ")});a.winEdit&&(a.recordDoubleClick=function(b,c,e,f,g,k,l){b=eng.editWindowForm(a.winEdit,c._id,a.dataSource,h.initialCriteria);null!=b.form&&(b.form.fromGrid=h)});var h="TreeGrid"===a.gridType?isc.TreeGrid.create(a):isc.ListGrid.create(a);var l=h.canEditCell;h.canEditCell=function(a,b){var c=this.getRecord(a),e=this.getField(b).canEditModes;return e&&(c&&
-1==e.indexOf("update")||!c&&-1==e.indexOf("add"))?!1:(e=this.getField(b).canViewModes)&&(c&&-1==e.indexOf("update")||!c&&-1==e.indexOf("add"))?!1:l.call(h,a,b)};!0===a.canAdd&&(e.click=void 0===a.addButtonClick?function(b){a.winEdit?(b=eng.editWindowForm(a.winEdit,null,a.dataSource,h.initialCriteria),null!=b.form&&(b.form.fromGrid=h)):h.startEditingNew(h.initialCriteria)}:a.addButtonClick);!0===a.canPrint&&(f.click=void 0===a.printButtonClick?function(a){window.scrollTo(0,0);h.showPrintPreview()}:
a.printButtonClick);!0===a.canEditHilites&&(g.click=function(a){h.editHilites()});!0===a.canExport&&(void 0===a.exportButtonClick?(e=isc.Menu.create({autoDraw:!1,width:150,data:[{title:"Exportar Vista",icon:"[SKIN]/actions/download.png",click:function(){var a={query:{data:h.getCriteria()}};a.query.componentId=h.ID;h.autoFetchTextMatchStyle&&(a.query.textMatchStyle=h.autoFetchTextMatchStyle);var b=h.getSort();if(b){for(var c=[],e=0;e<b.length;e++)"descending"==b[e].direction?c.push("-"+b[e].property):
c.push(b[e].property);a.query.sortBy=c}if(b=h.getAllFields()){c={};for(e=0;e<b.length;e++)if(!b[e].excludeFromState){var f=b[e].name;b[e].editorProperties&&b[e].editorProperties.displayField&&(f=f+"."+b[e].editorProperties.displayField);c[f]=b[e].title}a.fields=c}a="/ex"+h.getDataSource().dataURL.substring(3+eng.contextPath.length)+"&ext=csv&data="+encodeURI(JSON.stringify(a));window.location.href=eng.contextPath+a}},{title:"Exportar DS",click:function(){var a={query:{data:h.getCriteria()}};a.query.componentId=
h.ID;h.autoFetchTextMatchStyle&&(a.query.textMatchStyle=h.autoFetchTextMatchStyle);var b=h.getSort();if(b){for(var c=[],e=0;e<b.length;e++)"descending"==b[e].direction?c.push("-"+b[e].property):c.push(b[e].property);a.query.sortBy=c}a="/ex"+h.getDataSource().dataURL.substring(3+eng.contextPath.length)+"&ext=csv&data="+encodeURI(JSON.stringify(a));window.location.href=eng.contextPath+a}}]}),k.menu=e):k.click=a.exportButtonClick);if(!0===a.autoResize){var m=window.onresize;window.onresize=function(){h.setHeight(window.innerHeight-
a.resizeHeightMargin);h.setWidth(window.innerWidth-a.resizeWidthMargin);m&&m()};h.setHeight(window.innerHeight-a.resizeHeightMargin);h.setWidth(window.innerWidth-a.resizeWidthMargin)}return h},createForm:function(a,b,c){var e=eng.getDataSourceObjDef(c);c=eng.createDataSource(e);var f=eng.utils.cloneObject(a);void 0===f.numCols&&(f.numCols=2);void 0===f.titleOrientation&&(f.titleOrientation="left");void 0===f.titleAlign&&(f.titleAlign="right");void 0===f.cellPadding&&(f.cellPadding=5);void 0===f.dataSource&&
(f.dataSource=c);f.width&&delete f.width;f.height&&delete f.height;void 0===f.showTabs&&(f.showTabs=!0);void 0===f.processInit&&(f.processInit=!1);void 0===f.processChange&&(f.processChange=!1);f.title&&delete f.title;eng.processFields(f.fields);f.autoDraw=!1;var g=isc.DynamicForm.create(f),k=[];if(!1!==g.canPrint){var h=isc.IButton.create({title:"Imprimir",autoDraw:!1,click:function(a){window.scrollTo(0,0);0<g.layout.members.length?g.layout.showPrintPreview():g.showPrintPreview()}});k.push(h)}if(!1!==
g.canEdit){var l=isc.IButton.create({title:"Guardar",autoDraw:!1,click:function(a){formsubmit=a.target.form;isc.confirm("\u00bfDesea guardar la informaci\u00f3n?","value = value ? 'OK' : 'Cancel'; if(value == 'OK'){eng.submit(formsubmit);}")}});l.form=g;k.push(l)}var m=isc.VStack.create({members:[g],autoDraw:!1}),n=m;if(!0===f.showTabs){var p={title:a.title,autoDraw:!1,pane:m};n=isc.TabSet.create({ID:e.dsName+"Tabs",autoDraw:!1,border:0,tabs:[p]});g.tabs=n;g.tabs.tabSelected=function(){var a=g.tabs.getSelectedTab().pane;
d=a.getWidth()==a.getScrollWidth()?50:64;g.tabs.setHeight(a.getScrollHeight()+d)}}e=isc.HLayout.create({height:"20px",padding:"0px",membersMargin:20,align:"left",members:[],autoDraw:!1});e.hide();k=isc.HLayout.create({height:"20px",padding:"10px",membersMargin:20,align:"right",members:k,autoDraw:!1});a=isc.VLayout.create({membersMargin:5,left:a.left,top:a.top,width:a.width,height:a.height,members:[e,n,k],position:"relative"});a.setZIndex(0);g.layout=a;g.submitButton=l;g.printButton=h;g.topButtons=
e;g.buttons=k;g.tindex=0;g.addTopButton=function(a){g.topButtons.addMember(a);g.topButtons.show()};eng.addLinks(c.links,n,p,m,g);h=g.getItems();for(l=0;l<h.length;l++){if(p=h[l].canEditModes)b&&null!=b&&-1==p.indexOf("update")&&h[l].setEnabled(!1),b&&null!=b||-1!=p.indexOf("add")||h[l].setEnabled(!1);if(p=h[l].canViewModes)b&&null!=b&&-1==p.indexOf("update")&&h[l].hide(),b&&null!=b||-1!=p.indexOf("add")||h[l].hide()}if(b&&null!=b)eng.fetchForm(g,{_id:b},function(){g.processInit&&g.submit(function(){},
{operationType:"init"});g.tabs&&g.tabs.tabSelected();if(g.onLoad)g.onLoad(g)});else if(g.tabs&&g.tabs.tabSelected(),g.onLoad)g.onLoad(g);if(g.processChange)for(b=0;b<g.items.length;b++)g.items[b].editorEnter=function(a,b,c){b._swf_enterValue=c},g.items[b].editorExit=function(a,b,c){""+b._swf_enterValue!==""+c&&a.submit(function(){},{operationType:"change",field:b.name})};eng.resize(g);eng.onbeforeunloadForms.push(g);return g},editWindowForm:function(a,b,c,e){a=eng.utils.cloneObject(a);e&&(a.values=
e);e=eng.utils.removeAttribute(a,"width");var f=eng.utils.removeAttribute(a,"height");b=eng.createForm(a,b,c);c=b.parentElement.parentElement.parentElement;e||(e="90%");f||(f="80%");a=isc.Window.create({canDragResize:!0,title:a.title,width:e,height:f,autoCenter:!0,isModal:!0,showModalMask:!0,autoDraw:!1,closeClick:function(){this.Super("closeClick",arguments)},items:[b.topButtons,c,b.buttons]});a.animateShow("slide",null,500,"smoothStart");a.form=b;return b.window=a},filterFields:function(a){ret=
[];if(a)for(var b=0;b<a.length;b++){var c=a[b];if(!c.isRemoveField){ret[b]={};for(var e in c)c.hasOwnProperty(e)&&(e.startsWith("$")||"align"==e||"masterIndex"==e||(ret[b][e]=c[e]))}}return ret},getPrimaryKey:function(a){if(a)for(var b=0;b<a.length;b++)if(a[b].primaryKey)return a[b].name;return null},processFields:function(a){if(a)for(var b=0;b<a.length;b++){a[b]=eng.processField(a[b]);var c=a[b].validators;if(c)for(var e=0;e<c.length;e++)c[e]=eng.processValidator(c[e]);a[b].fields&&eng.processFields(a[b].fields)}},
processField:function(a){var b=a.stype;return b?eng.fieldProcesors[b]?eng.fieldProcesors[b](a):a:a},processValidator:function(a){var b=a.stype;b&&(b=eng.validators[b])&&(a=eng.utils.clonAndMergeObjects(b,a),eng.utils.removeAttribute(a,"stype"));return a},utils:{cloneObject:function(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor(),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=eng.utils.cloneObject(a[c]));return b},clonAndMergeObjects:function(a,b){a=eng.utils.cloneObject(a);if(null==b||"object"!=
typeof b)return a;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},getSynchData:function(a,b,c){"undefined"===typeof XMLHttpRequest&&(XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(f){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(f){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(f){}throw Error("This browser does not support XMLHttpRequest.");});var e=new XMLHttpRequest;b?(c||(c="POST"),e.open(c,a,!1),e.send(b)):(c||(c="GET"),e.open(c,
a,!1),e.send());return e},loadJS:function(a,b,c,e,f){var g=!0;b&&1==b&&(g=!1);if(!0===c){if(b=e?localStorage.getItem(a):sessionStorage.getItem(a),null==b){b=eng.utils.getSynchData(a+"?id="+(f?f:eng.id?eng.id:(new Date).getTime())).responseText+"\n////# sourceURL="+a+"\n";try{e?localStorage.setItem(a,b):sessionStorage.setItem(a,b)}catch(k){console.log(k,b.length)}}}else b=eng.utils.getSynchData(a+"?id="+(f?f:eng.id?eng.id:(new Date).getTime())).responseText+"\n////# sourceURL="+a+"\n";g?(aScript=document.createElement("script"),
aScript.type="text/javascript",aScript.text=b,document.getElementsByTagName("head")[0].appendChild(aScript)):eval(b)},loadCSS:function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a.startsWidth("/")?eng.contextPath+a:a);"undefined"!=typeof b&&document.getElementsByTagName("head")[0].appendChild(b)},filterObj:function(a){for(var b in a)"$"===b.charAt(0)&&delete a[b]},copyAttributes:function(a,b,c){void 0===c&&(c=
!1);if(!a)return b;for(var e in a)"$"!==e.charAt(0)&&(!0!==c&&b[e]||(b[e]=a[e]));return b},clearAttributes:function(a){for(var b in a)"$"!==b.charAt(0)&&delete a[b]},removeAttribute:function(a,b){var c=a[b];c&&delete a[b];return c},findParentNode:function(a,b){for(b=b.parentNode;b&&b.tagName!=a;)b=b.parentNode;return b},getURLParameter:function(a){for(var b=window.location.search.substring(1).split("&"),c=0;c<b.length;c++){var e=b[c].split("=");if(e[0]==a)return e[1]}},getAnchorParameter:function(a){for(var b=
window.location.hash.substring(1).split("&"),c=0;c<b.length;c++){var e=b[c].split("=");if(e[0]==a)return e[1]}},getAnchorPath:function(a){var b=window.location.hash.substring(1);"/"===b.charAt(0)&&(b=b.substring(1));b=b.split("/");if(a<b.length)return b[a]},getDataSourceDisplayFields:function(a){if(a=eng.dataSources[a]){for(var b="\n    fields: [\n",c=0;c<a.fields.length;c++)b+='        {name: "'+a.fields[c].name+'"}',c+1<a.fields.length&&(b+=","),b+="\n";return b+"    ]\n"}}},showError:function(a){console.error(a)},
getDataSource:function(a){return{name:a,getName:function(){return this.name},getDataSourceScript:function(){return eng.dataSources[this.name]},getDataSourceScriptField:function(a){for(var b=this.getDataSourceScript().fields,e=0;e<b.length;e++){var f=b[e];if(f.name==a)return f}},invokeDS:function(a){a=eng.utils.getSynchData(eng.contextPath+eng.dataSourceServlet+"?dssp="+eng.dataSourceScriptPath+"&ds="+this.name,JSON.stringify(a));if(200==a.status){var b=JSON.parse(a.response);if(b.response)return b.response;
eng.showError("Bad DSResponse ("+a.response+")")}else eng.showError("Bad HttpResponse ("+a.status+")")},fetch:function(a){a||(a={});a.operationType="fetch";if(this.getDataSourceScript()&&!0===this.getDataSourceScript().clientOnly){var b=eng.createDataSource(this.name);a=b.applyFilter(b.cacheData,a.data);a={status:0,endRow:a.length,startRow:0,totalRows:a.length,data:a}}else a=this.invokeDS(a);return a},aggregate:function(a){a||(a={});a.operationType="aggregate";return this.invokeDS(a)},fetchObj:function(a){var b=
{};"string"===typeof a?"{"===a.charAt(0)?b.data=JSON.parse(a):b.data={_id:a}:b.data=a;return this.fetch(b)},fetchObjById:function(a){if((a=this.fetch({data:{_id:a}}))&&0===a.status)return a.data[0]},add:function(a){if(a)return a.operationType="add",this.invokeDS(a)},addObj:function(a){eng.utils.filterObj(a);var b=this.add({data:a});b&&0===b.status&&(a._id=b.data._id);return b},update:function(a){if(a)return a.operationType="update",this.invokeDS(a)},updateObj:function(a){eng.utils.filterObj(a);return this.update({data:a})},
remove:function(a){if(a)return a.operationType="remove",this.invokeDS(a)},removeObj:function(a){eng.utils.filterObj(a);return this.remove({data:a})},removeObjById:function(a){return this.removeObj({_id:a})},validate:function(a){if(a)return a.operationType="validate",this.invokeDS(a)},validateObj:function(a){eng.utils.filterObj(a);return this.validate({data:a})},toValueMap:function(a,c){var b=this.fetch().data;if(c)for(var f={},g=0;g<b.length;g++)f[b[g][a]]=b[g][c];else for(f=[],g=0;g<b.length;g++)f[g]=
b[g][a];return f},$asArray:function(){var a=this,c=this.fetch(),e=c.data;e||(alert(c.status),e=[]);e.then=function(a){a();return e};e.$add=function(b){var c=a.addObj(b);0===c.status?b&&e.push(c.data):alert("Error:"+c.status);return e};e.$remove=function(b){for(var c=e.length;c--;)e[c]._id==b._id&&(e.splice(c,1),a.removeObjById(b._id));return e};e.$save=function(b){for(var c=e.length;c--;)e[c]._id==b._id&&(e[c]=b,a.updateObj(b));return e};e.$indexFor=function(a){for(var b=e.length;b--;)if(e[b]._id==
a)return b};return e}}},getProcessStates:function(a){var b={};if(a=eng.getDataSource("SWBF_State").fetch({data:{prop:a}}).data)for(var c=0;c<a.length;c++)b[a[c].value]=a[c].name;return b},login:function(a,b){a=eng.utils.getSynchData(eng.contextPath+eng.dataSourceServlet+"?dssp="+eng.dataSourceScriptPath,JSON.stringify({username:a,password:b,operationType:"login"}));if(200==a.status)return a=JSON.parse(a.response).response,a.data&&(eng._u={usr:a.data}),a},logout:function(){var a=eng.utils.getSynchData(eng.contextPath+
eng.dataSourceServlet+"?dssp="+eng.dataSourceScriptPath,JSON.stringify({operationType:"logout"}));if(200==a.status)return eng._u={usr:void 0},JSON.parse(a.response).response},getUser:function(){if(eng._u)return eng._u.usr;var a=eng.utils.getSynchData(eng.contextPath+eng.dataSourceServlet+"?dssp="+eng.dataSourceScriptPath,JSON.stringify({operationType:"user"}));if(200==a.status)return a=JSON.parse(a.response).response,eng._u=a.data?{usr:a.data}:{usr:void 0},eng._u.usr},getContextData:function(a){var b=
{operationType:"contextData"};b.dataKey=a;a=eng.utils.getSynchData(eng.contextPath+eng.dataSourceServlet+"?dssp="+eng.dataSourceScriptPath,JSON.stringify(b));if(200==a.status)return JSON.parse(a.response).response.data},findLinkObjectId:function(a,b,c){var e={};e[b]=c;a=eng.getDataSource(a).fetch({data:e}).data;b=null;a&&a[0]&&(b=a[0]._id);return b},initPlatform:function(a,b){for(var c=!0,e=!0,f=!0,g=!1,k=!0,h=document.getElementsByTagName("script"),l=0;l<h.length;l++){var m=h[l].src;if(m){var n=
m.indexOf("/eng."),p=m.indexOf("?id=");-1<n&&-1<p&&(eng.id=m.substring(p+4),eng.contextPath=m.substring(m.indexOf("/",8),m.indexOf("/platform/")),isomorphicDir=eng.contextPath+isomorphicDir)}}"boolean"===typeof b?c=b:"object"===typeof b&&(void 0!==b.engId&&(eng.id=b.engId),void 0!==b.cache&&(c=b.cache),void 0!==b.isc&&(e=b.isc),void 0!==b.isc_load&&(f=b.isc_load),void 0!==b.isc_calendar&&(g=b.isc_calendar),void 0!==b.isc_richTextEditor&&(k=b.isc_richTextEditor));c&&(sessionStorage.getItem("engId")!=
eng.id&&(sessionStorage.clear(),sessionStorage.setItem("engId",eng.id)),localStorage.getItem("staticVersion")!=eng.staticVersion&&(localStorage.clear(),localStorage.setItem("staticVersion",eng.staticVersion)));if(!eng.inited){eng.inited=!0;e&&(f&&"undefined"===typeof isc&&(eng.utils.loadJS(isomorphicDir+"system/modules/ISC_Core.js",!1,c,!0,eng.staticVersion),eng.utils.loadJS(isomorphicDir+"system/modules/ISC_Foundation.js",!1,c,!0,eng.staticVersion),eng.utils.loadJS(isomorphicDir+"system/modules/ISC_Containers.js",
!1,c,!0,eng.staticVersion),eng.utils.loadJS(isomorphicDir+"system/modules/ISC_Grids.js",!1,c,!0,eng.staticVersion),eng.utils.loadJS(isomorphicDir+"system/modules/ISC_Forms.js",!1,c,!0,eng.staticVersion),eng.utils.loadJS(isomorphicDir+"system/modules/ISC_DataBinding.js",!1,c,!0,eng.staticVersion),k&&eng.utils.loadJS(isomorphicDir+"system/modules/ISC_RichTextEditor.js",!1,c,!0,eng.staticVersion),g&&eng.utils.loadJS(isomorphicDir+"system/modules/ISC_Calendar.js",!1,c,!0,eng.staticVersion),eng.utils.loadJS(isomorphicDir+
"skins/Tahoe/load_skin.js",!1,c,!0,eng.staticVersion),eng.utils.loadJS(isomorphicDir+"locales/frameworkMessages_es.properties",!1,c,!0,eng.staticVersion),eng.utils.loadJS(eng.contextPath+"/platform/plupload/js/plupload.full.min.js",!1,c,!0,eng.staticVersion)),isc.DateItem.DEFAULT_START_DATE.setYear(1900),isc.Canvas.resizeControls(10),isc.Canvas.resizeFonts(1),Page.setEvent("load",function(){}),b=(new Date).getTimezoneOffset()/-60,Time.setDefaultDisplayTimezone((0>b?"-":"+")+(9<Math.abs(b)?Math.abs(b):
"0")+Math.abs(b)+":00"),Time.adjustForDST=!1,NumberUtil.decimalSymbol=".",NumberUtil.groupingSymbol=",",eng.utils.loadJS(eng.contextPath+"/platform/js/eng_lang.min.js",!1,c,!0,eng.staticVersion),isc.RPCManager.addClassProperties({handleError:function(a,b){if(a.data)if("string"===typeof a.data)isc.warn(a.data);else if("object"===typeof a.data){b=window[a.context.componentId];var c=a.data._errors,e=a.data._hints,f=a.data._msg,g=a.data._enabled,k=a.data._visible;delete a.data._errors;delete a.data._hints;
delete a.data._msg;delete a.data._enabled;delete a.data._visible;for(var h in a.data)b.setValue(h,a.data[h]);if(c){a="";for(h in c)b.setFieldErrors(h,c[h]),a+="<b>"+b.getItem(h).title+"</b>: "+c[h]+"<br>",b.setFocusItem(h);f||(f=a)}if(e)for(h in c)b.getItem(h).setHint(e[h]);if(g)for(h in g)b.getItem(h).setDisabled(!g[h]);if(k)for(h in k)k[h]?b.getItem(h).show():b.getItem(h).hide();b.redraw();f&&isc.warn(f);for(h in c){b.setFocus(h);break}}return!1}}));if("string"===typeof a)"/"!=a.charAt(0)?eng.dataSourceScriptPath=
window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"))+"/"+a:eng.dataSourceScriptPath=a,eng.utils.loadJS(eng.contextPath+a,!1,c);else if(Array.isArray(a))for(eng.dataSourceScriptPath=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"))+"/"+JSON.stringify(a),n=0;n<a.length;n++)eng.utils.loadJS(eng.contextPath+a[n],!1,c);window.console.warn=function(){};window.onbeforeunload=function(){return eng.onbeforeunload()}}},require:function(a,b){b||0==b||
(b=!0);if("string"===typeof a){var c=a="/"!=a.charAt(0)?window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"))+"/"+a:eng.contextPath+a,e=a.indexOf("?");-1<e&&(c=a.substring(0,e));-1==eng._requires.indexOf(c)&&(eng.utils.loadJS(a,!1,b),eng._requires.push(c))}}};eng.dataStores.mongodb={};